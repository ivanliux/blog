<!DOCTYPE HTML>
<html lang="zh-CN">
<head>
    <!--Setting-->
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
    <meta http-equiv="Cache-Control" content="no-siteapp">
    <meta http-equiv="Cache-Control" content="no-transform">
    <meta name="renderer" content="webkit|ie-comp|ie-stand">
    <meta name="apple-mobile-web-app-capable" content="ncnom&#39;s blog">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="format-detection" content="telephone=no,email=no,adress=no">
    <meta name="browsermode" content="application">
    <meta name="screen-orientation" content="portrait">
    <link rel="dns-prefetch" href="http://yoursite.com">
    <!--SEO-->





<meta name="robots" content="all" />
<meta name="google" content="all" />
<meta name="googlebot" content="all" />
<meta name="verify" content="all" />
    <!--Title-->


<title>Ubuntu搭建Nginx图片服务器 | ncnom&#39;s blog</title>


    <link rel="alternate" href="/atom.xml" title="ncnom&#39;s blog" type="application/atom+xml">


    <link rel="icon" href="/favicon.ico">

    



<link rel="stylesheet" href="/css/bootstrap.min.css?rev=3.3.7.css">
<link rel="stylesheet" href="/css/font-awesome.min.css?rev=4.5.0.css">
<link rel="stylesheet" href="/css/style.css?rev=@@hash.css">




    





    

</head>


<!--[if lte IE 8]>
<style>
    html{ font-size: 1em }
</style>
<![endif]-->
<!--[if lte IE 9]>
<div style="ie">你使用的浏览器版本过低，为了你更好的阅读体验，请更新浏览器的版本或者使用其他现代浏览器，比如Chrome、Firefox、Safari等。</div>
<![endif]-->

<body>
    <header class="main-header"  style="background-image:url(http://snippet.shenliyang.com/img/banner.jpg)"  >
    <div class="main-header-box">
        <a class="header-avatar" href="/" title='ncmon'>
            <img src="/img/avatar.jpg" alt="logo头像" class="img-responsive center-block">
        </a>
        <div class="branding">
        	<!--<h2 class="text-hide">Snippet主题,从未如此简单有趣</h2>-->
            
                 <img src="/img/branding.png" alt="Snippet 博客主题" class="img-responsive center-block">
            
    	</div>
    </div>
</header>
    <nav class="main-navigation">
    <div class="container">
        <div class="row">
            <div class="col-sm-12">
                <div class="navbar-header"><span class="nav-toggle-button collapsed pull-right" data-toggle="collapse" data-target="#main-menu" id="mnav">
                    <span class="sr-only"></span>
                        <i class="fa fa-bars"></i>
                    </span>
                    <a class="navbar-brand" href="http://yoursite.com">ncnom&#39;s blog</a>
                </div>
                <div class="collapse navbar-collapse" id="main-menu">
                    <ul class="menu">
                        
                            <li role="presentation" class="text-center">
                                <a href="/"><i class="fa "></i>首页</a>
                            </li>
                        
                            <li role="presentation" class="text-center">
                                <a href="/categories/技术栈/"><i class="fa "></i>技术栈</a>
                            </li>
                        
                            <li role="presentation" class="text-center">
                                <a href="/categories/错误志/"><i class="fa "></i>错误志</a>
                            </li>
                        
                            <li role="presentation" class="text-center">
                                <a href="/archives/"><i class="fa "></i>时间轴</a>
                            </li>
                        
                    </ul>
                </div>
            </div>
        </div>
    </div>
</nav>
    <section class="content-wrap">
        <div class="container">
            <div class="row">
                <main class="col-md-8 main-content m-post">
                    <p id="process"></p>
<article class="post">
    <div class="post-head">
        <h1 id="Ubuntu搭建Nginx图片服务器">
            
	            Ubuntu搭建Nginx图片服务器
            
        </h1>
        <div class="post-meta">
    
    
    <span class="categories-meta fa-wrap">
        <i class="fa fa-folder-open-o"></i>
        <a href="/categories/技术栈">
            技术栈
        </a>
    </span>
    

    
    <span class="fa-wrap">
        <i class="fa fa-tags"></i>
        <span class="tags-meta">
            
                
                    <a href="/tags/Linux" title='Linux'>
                        Linux
                    </a>
                
                    <a href="/tags/Ubuntu" title='Ubuntu'>
                        Ubuntu
                    </a>
                
                    <a href="/tags/FTP" title='FTP'>
                        FTP
                    </a>
                
            
        </span>
    </span>
    

    
        
        <span class="fa-wrap">
            <i class="fa fa-clock-o"></i>
            <span class="date-meta">2018/01/11</span>
        </span>
        
    
</div>

            
            
    </div>
    
    <div class="post-body post-content">
        <p>也许算作是建站以来的第一篇真正意义上的总结博客。  </p>
<p>首先感谢开源本主题的viosey同学和辛苦维护本主题的neoFelhz同学，对此主题极为喜欢。</p>
<p>新发现了当前的这个Meterial主题后发现居然有一个Gallery模板可以展示照片，平时的博客使用图片需要存放在一个位置上，平时也有一些业余的摄影爱好需要刚好可以存放，当然可以使用如之前使用过的七牛云等云对象存储平台存储使用，我这里也是刚好有个云服务器可以做存储就想着自己搭建一个图片服务器方便管理，也刚好能学习一下服务器方面的一些知识，经多次尝试，故总结一下,话不多说，开始行动.</p>
<a id="more"></a>
<h1 id="环境准备"><a href="#环境准备" class="headerlink" title="环境准备"></a>环境准备</h1><p>Ubuntu版本Ubuntu 16.04.3</p>
<h1 id="安装Nginx"><a href="#安装Nginx" class="headerlink" title="安装Nginx"></a>安装Nginx</h1><p>首先是准备编译Nginx的前期准备工作  </p>
<h2 id="先更新一下源"><a href="#先更新一下源" class="headerlink" title="先更新一下源"></a>先更新一下源</h2><pre><code>&gt; apt-get update
</code></pre><h2 id="安装gcc-g-依赖库"><a href="#安装gcc-g-依赖库" class="headerlink" title="安装gcc g++依赖库"></a>安装gcc g++依赖库</h2><pre><code>&gt; apt-get install build-essential
&gt; apt-get install libtool
</code></pre><h2 id="安装prce依赖库"><a href="#安装prce依赖库" class="headerlink" title="安装prce依赖库"></a>安装prce依赖库</h2><pre><code>&gt; apt-get install libpcre3 libpcre3-dev
</code></pre><h2 id="安装-zlib依赖库"><a href="#安装-zlib依赖库" class="headerlink" title="安装 zlib依赖库"></a>安装 zlib依赖库</h2><pre><code>&gt; apt-get install zlib1g-dev
</code></pre><h2 id="安装-ssl依赖库"><a href="#安装-ssl依赖库" class="headerlink" title="安装 ssl依赖库"></a>安装 ssl依赖库</h2><pre><code>&gt; apt-get install openssl
</code></pre><h2 id="编译Nginx"><a href="#编译Nginx" class="headerlink" title="编译Nginx"></a>编译Nginx</h2><p>下载<a href="http://nginx.org/en/download.html" target="_blank" rel="external">Nginx</a>有对应的版本，我这里下载是当前的最新版本1.13.8</p>
<pre><code>&gt; #解压下载下来的压缩包
&gt; tar -zxvf nginx-1.13.8.tar.gz
&gt; #进入解压目录
&gt; cd nginx-1.13.8
&gt; #配置并生成makefile
&gt; ./configure --prefix=/usr/local/nginx 
&gt; #编译
&gt; make
&gt; #安装
&gt; make install
&gt; #启动Nginx
&gt; /usr/local/nginx/sbin/nginx -c /usr/local/nginx/conf/nginx.conf
</code></pre><p>此时Nginx就安装完成了，会使用默认的80端口启动，如果有启动apache2服务的这里会用冲突，这里不是重点，可查询解决，启动完成可直接通过服务器ip或者云解析的域名查看默认网页  </p>
<p>默认的网页长这个样子<br><img src="https://ncmon-blog.oss-cn-beijing.aliyuncs.com/image6.png" alt="Nginx-default-index"></p>
<h1 id="安装与配置vsftpd"><a href="#安装与配置vsftpd" class="headerlink" title="安装与配置vsftpd"></a>安装与配置vsftpd</h1><h2 id="安装vsftpd"><a href="#安装vsftpd" class="headerlink" title="安装vsftpd"></a>安装vsftpd</h2><pre><code>&gt; apt-get install vsftpd
</code></pre><h2 id="启动vsftpd服务"><a href="#启动vsftpd服务" class="headerlink" title="启动vsftpd服务"></a>启动vsftpd服务</h2><pre><code>&gt;service vsftpd start
</code></pre><h2 id="新建ftpuser目录作为ftp主目录-（ftpuser为目录名，随个人喜好创建）"><a href="#新建ftpuser目录作为ftp主目录-（ftpuser为目录名，随个人喜好创建）" class="headerlink" title="新建ftpuser目录作为ftp主目录 （ftpuser为目录名，随个人喜好创建）"></a>新建ftpuser目录作为ftp主目录 （ftpuser为目录名，随个人喜好创建）</h2><pre><code>&gt;mkdir /home/ftpuser
</code></pre><h2 id="新建ftpuser用户指定用户主目录和设置用户密码-（ftpuser为用户名，随个人喜好创建）"><a href="#新建ftpuser用户指定用户主目录和设置用户密码-（ftpuser为用户名，随个人喜好创建）" class="headerlink" title="新建ftpuser用户指定用户主目录和设置用户密码 （ftpuser为用户名，随个人喜好创建）"></a>新建ftpuser用户指定用户主目录和设置用户密码 （ftpuser为用户名，随个人喜好创建）</h2><pre><code>&gt;useradd -d /home/ftpuser -s /bin/bash ftpuser
&gt;passwd ftpuser
</code></pre><h2 id="制定用户组"><a href="#制定用户组" class="headerlink" title="制定用户组"></a>制定用户组</h2><pre><code>&gt;chown ftpuser:ftpuser /home/ftpuser
</code></pre><h2 id="新建文件-etc-vsftpd-user-list，用于存放允许访问ftp的用户"><a href="#新建文件-etc-vsftpd-user-list，用于存放允许访问ftp的用户" class="headerlink" title="新建文件/etc/vsftpd.user_list，用于存放允许访问ftp的用户"></a>新建文件/etc/vsftpd.user_list，用于存放允许访问ftp的用户</h2><pre><code>&gt;vim /etc/vsftpd.user_list
</code></pre><p><img src="https://ncmon-blog.oss-cn-beijing.aliyuncs.com/image7.png" alt="ftp-user_list"></p>
<h2 id="编辑vsftpd配置文件"><a href="#编辑vsftpd配置文件" class="headerlink" title="编辑vsftpd配置文件"></a>编辑vsftpd配置文件</h2><pre><code>&gt;vim /etc/vsftpd.conf
做如下修改：   
　　打开注释 write_enable=YES   
　　添加信息 userlist_file=/etc/vsftpd.user_list   
　　添加信息 userlist_enable=YES   
　　添加信息 userlist_deny=NO 
　　修改完成后保存退出。
</code></pre><h2 id="重启vsftpd服务"><a href="#重启vsftpd服务" class="headerlink" title="重启vsftpd服务"></a>重启vsftpd服务</h2><pre><code>&gt;service vsftpd restart
</code></pre><p>这是可以使用filezilla等ftp软件使用刚刚新建的用户名和密码访问测试是否成功</p>
<p>OK，准备工作完成开始上传图片，开始正式图片服务器工作</p>
<h2 id="创建存储图片的根目录-（在ftpuser目录下-我这里使用www-images）"><a href="#创建存储图片的根目录-（在ftpuser目录下-我这里使用www-images）" class="headerlink" title="创建存储图片的根目录 （在ftpuser目录下,我这里使用www/images）"></a>创建存储图片的根目录 （在ftpuser目录下,我这里使用www/images）</h2><pre><code>&gt;cd /home/ftpuser
&gt;mkdir -p www/images
</code></pre><h2 id="在nginx目录下创建images目录"><a href="#在nginx目录下创建images目录" class="headerlink" title="在nginx目录下创建images目录"></a>在nginx目录下创建images目录</h2><pre><code>&gt;mkdir /usr/local/nginx/html/images
</code></pre><h2 id="修改nginx-conf-nginx-conf在默认的server里再添加一个location并指定实际路径"><a href="#修改nginx-conf-nginx-conf在默认的server里再添加一个location并指定实际路径" class="headerlink" title="修改nginx/conf/nginx.conf在默认的server里再添加一个location并指定实际路径:"></a>修改nginx/conf/nginx.conf在默认的server里再添加一个location并指定实际路径:</h2><pre><code>location /images/ {
    root  /home/ftpuser/www/;
    autoindex on;
}  
</code></pre><p><img src="https://ncmon-blog.oss-cn-beijing.aliyuncs.com/image8.png" alt="images_nginx_conf"></p>
<h2 id="修改用户访问权限"><a href="#修改用户访问权限" class="headerlink" title="修改用户访问权限"></a>修改用户访问权限</h2><pre><code>&gt;chmod 755 /home/ftpuser/www/images
</code></pre><p>使用filezilla 等ftp工具使用ftpuser用户登录即可上传图片</p>
<h1 id="测试"><a href="#测试" class="headerlink" title="测试"></a>测试</h1><p><img src="https://ncmon-blog.oss-cn-beijing.aliyuncs.com/image9.png" alt="ftp_upload_test"><br>送上一张最近的长安街慢门效果照片<em>★,°</em>:.☆(￣▽￣)/$:<em>.°★</em>。大功告成！ 撒花！<br><img src="https://ncmon-blog.oss-cn-beijing.aliyuncs.com/image10.png" alt="image_test_result"></p>

    </div>
    
    <div class="post-footer">
        <div>
            
                转载声明：商业转载请联系作者获得授权,非商业转载请注明出处 © <a href="" target="_blank">ncmon</a>
            
        </div>
        <div>
            
        </div>
    </div>
</article>

<div class="article-nav prev-next-wrap clearfix">
    
        <a href="/2018-09-26-Jetpack-Architecture-ViewModel/" class="pre-post btn btn-default" title='Android Jetpack Architecture之ViewModel'>
            <i class="fa fa-angle-left fa-fw"></i><span class="hidden-lg">上一篇</span>
            <span class="hidden-xs">Android Jetpack Architecture之ViewModel</span>
        </a>
    
    
        <a href="/2018-01-07-Android-Studio-Error-2/" class="next-post btn btn-default" title='Android Studio import project 出现Error错误 程序包org.apache.http不存在'>
            <span class="hidden-lg">下一篇</span>
            <span class="hidden-xs">Android Studio import project 出现Error错误 程序包org.apache.http不存在</span><i class="fa fa-angle-right fa-fw"></i>
        </a>
    
</div>


    <div id="comments">
        
   <p>评论系统未开启，无法评论！</p>

    </div>





                </main>
                
                    <aside id="article-toc" role="navigation" class="col-md-4">
    <div class="widget">
        <h3 class="title">文章目录</h3>
        
            <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#环境准备"><span class="toc-text">环境准备</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#安装Nginx"><span class="toc-text">安装Nginx</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#先更新一下源"><span class="toc-text">先更新一下源</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#安装gcc-g-依赖库"><span class="toc-text">安装gcc g++依赖库</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#安装prce依赖库"><span class="toc-text">安装prce依赖库</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#安装-zlib依赖库"><span class="toc-text">安装 zlib依赖库</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#安装-ssl依赖库"><span class="toc-text">安装 ssl依赖库</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#编译Nginx"><span class="toc-text">编译Nginx</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#安装与配置vsftpd"><span class="toc-text">安装与配置vsftpd</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#安装vsftpd"><span class="toc-text">安装vsftpd</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#启动vsftpd服务"><span class="toc-text">启动vsftpd服务</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#新建ftpuser目录作为ftp主目录-（ftpuser为目录名，随个人喜好创建）"><span class="toc-text">新建ftpuser目录作为ftp主目录 （ftpuser为目录名，随个人喜好创建）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#新建ftpuser用户指定用户主目录和设置用户密码-（ftpuser为用户名，随个人喜好创建）"><span class="toc-text">新建ftpuser用户指定用户主目录和设置用户密码 （ftpuser为用户名，随个人喜好创建）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#制定用户组"><span class="toc-text">制定用户组</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#新建文件-etc-vsftpd-user-list，用于存放允许访问ftp的用户"><span class="toc-text">新建文件/etc/vsftpd.user_list，用于存放允许访问ftp的用户</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#编辑vsftpd配置文件"><span class="toc-text">编辑vsftpd配置文件</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#重启vsftpd服务"><span class="toc-text">重启vsftpd服务</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#创建存储图片的根目录-（在ftpuser目录下-我这里使用www-images）"><span class="toc-text">创建存储图片的根目录 （在ftpuser目录下,我这里使用www/images）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#在nginx目录下创建images目录"><span class="toc-text">在nginx目录下创建images目录</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#修改nginx-conf-nginx-conf在默认的server里再添加一个location并指定实际路径"><span class="toc-text">修改nginx/conf/nginx.conf在默认的server里再添加一个location并指定实际路径:</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#修改用户访问权限"><span class="toc-text">修改用户访问权限</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#测试"><span class="toc-text">测试</span></a></li></ol>
        
    </div>
</aside>

                
            </div>
        </div>
    </section>
    <footer class="main-footer">
    <div class="container">
        <div class="row">
        </div>
    </div>
</footer>

<a id="back-to-top" class="icon-btn hide">
	<i class="fa fa-chevron-up"></i>
</a>




    <div class="copyright">
    <div class="container">
        <div class="row">
            <div class="col-sm-12">
                <div class="busuanzi">
    
</div>

            </div>
            <div class="col-sm-12">
                <span>Copyright &copy; 2018
                </span> |
                <span>
                    Powered by <a href="//hexo.io" class="copyright-links" target="_blank" rel="nofollow">Hexo</a>
                </span> |
                <span>
                    Theme by <a href="//github.com/shenliyang/hexo-theme-snippet.git" class="copyright-links" target="_blank" rel="nofollow">Snippet</a>
                </span>
            </div>
        </div>
    </div>
</div>







<script src="/js/app.js?rev=@@hash.js"></script>

</body>
</html>