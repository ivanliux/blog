{"title":"RecyclerView排雷--notifyItemRemoved下标（position）不能更新","date":"2017-10-29T15:48:52.000Z","slug":"RecyclerView-clear-of-mines-1","categories":["技术栈"],"updated":"2018-01-07T15:35:18.958Z","content":"<p>用以显示列表类型的UI我们经常使用ListView，GridView，Google推出RecyclerView之后，大部分的使用均转换到了RecyclerView中，可定制化十分强，但是使用过程中难免碰到一些问题，之前使用ListView多是使用notifyDataSetChanged（）更新数据，使用RecyclerView删除时，为了使用其自身的删除过度动画使用notifyItemRemoved删除，那么就碰到了一个问题，再onBindViewHolder中设置了setTag（position）</p>\n<pre><code>@Override\npublic void onBindViewHolder(RecyclerView.ViewHolder holder,int position){\n    //...\n    holder.itemView.setTag(position)\n    //...\n}\n</code></pre><p>直接使用notifyItemRemoved(posiaon)删除会导致该下标不能更新就导致一系列的Bug（/衰）查询到了解决办法特此记录一下:为了修复该问题删除之后需要调用notifyItenRangeChanged方法，使下面的itemview重新onBind:</p>\n<pre><code>public void deleteItem(int position){\n    mDataList.remove(position);\n    notifyItemRemoved(position);\n    if(position != mDataList.size()){ // 如果移除的是最后一个，忽略\n        notifyItemRangeChanged(position, mDataList.size() - position);\n    }\n}\n</code></pre><p>如果不需要使用动画或更改自定义的动画效果可以添加一下代码</p>\n<pre><code>mRecyclerView.setItemAnimator(newDefaultItemAnimator());\n</code></pre>","prev":{"title":"Android Studio import project 出现Error错误 程序包org.apache.http不存在","slug":"Android-Studio-Error-2"},"next":{"title":"Android Studio 更新后出现Error:No service of type Factory  available in ProjectScopeServices.解决办法","slug":"Android-Studio-Error-1"},"link":"http://yoursite.com/post/RecyclerView-clear-of-mines-1/","copyright":{"license":"Attribution-NonCommercial-NoDerivatives 4.0 International (<a href=\\\"https://creativecommons.org/licenses/by-nc-sa/4.0/\\\" rel=\\\"external nofollow noopener\\\" target=\\\"_blank\\\">CC BY-NC-ND 4.0</a>)","link":"<a href=\"http://yoursite.com/post/RecyclerView-clear-of-mines-1/\" title=\"RecyclerView排雷--notifyItemRemoved下标（position）不能更新\">http://yoursite.com/post/RecyclerView-clear-of-mines-1/</a>"}}