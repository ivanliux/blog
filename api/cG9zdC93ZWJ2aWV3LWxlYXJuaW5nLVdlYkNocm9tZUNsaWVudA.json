{"title":"Android WebViewå¿…çŸ¥å¿…ä¼š(3)-WebChromeClient","date":"2019-03-14T14:35:47.000Z","slug":"webview-learning-WebChromeClient","comments":true,"tags":["Android"],"categories":["æŠ€æœ¯æ ˆ"],"updated":"2019-03-23T06:29:14.825Z","content":"<h2 id=\"ç®€ä»‹\"><a href=\"#ç®€ä»‹\" class=\"headerlink\" title=\"ç®€ä»‹\"></a>ç®€ä»‹</h2><p>ğŸ˜€WebChromeClientï¼šå½“å½±å“â€æµè§ˆå™¨â€çš„äº‹ä»¶åˆ°æ¥æ—¶ï¼Œå°±ä¼šé€šè¿‡WebChromeClientä¸­çš„æ–¹æ³•å›è°ƒé€šçŸ¥ç”¨æ³•,æ‰€ä»¥WebChromeClientéƒ½æ˜¯å’Œæˆ‘ä»¬å¹³æ—¶ä½¿ç”¨æµè§ˆå™¨éœ€è¦çš„ä¸€äº›äº¤äº’æœ‰å¯†åˆ‡çš„è”ç³»ã€‚</p>\n<a id=\"more\"></a>\n<h2 id=\"è·å–ç½‘é¡µçš„åŠ è½½è¿›åº¦\"><a href=\"#è·å–ç½‘é¡µçš„åŠ è½½è¿›åº¦\" class=\"headerlink\" title=\"è·å–ç½‘é¡µçš„åŠ è½½è¿›åº¦\"></a>è·å–ç½‘é¡µçš„åŠ è½½è¿›åº¦</h2><ul>\n<li><p>void  onProgressChanged(WebView view, int newProgress)  ï¼›</p>\n<p>Tell the host application the current progress of loading a page. </p>\n<p>newProgress: Current page loading progress, represented by an integer between 0 and 100.</p>\n<p>å¤§å®¶ä¸€å®šè¦æ³¨æ„ï¼Œåº•å±‚å®ç°æ—¶ï¼Œæ˜¯åˆ©ç”¨handleræ¥å®šæ—¶è½®å¾ªå½“å‰è¿›åº¦çš„ï¼Œæ¯éš”ä¸€å®šæ—¶é—´æŸ¥è¯¢ä¸€æ¬¡ï¼Œæ‰€ä»¥æ¯æ¬¡æ‹¿åˆ°çš„è¿›åº¦æ•°æ®æ˜¯ä¸ä¸€æ ·çš„ã€‚ä¹Ÿå°±æ˜¯è¯´å¦‚æœé¡µé¢è¾ƒç®€å•ï¼Œå¯èƒ½ä¼šç›´æ¥è¿”å›100ï¼Œè€Œè·³è¿‡ä¸­é—´çš„å„ä¸ªæ•°æ®ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œé™¤äº†100ï¼Œå…¶å®ƒä»»ä½•ä¸€ä¸ªæ•°å€¼ä¸æ˜¯ä¸€å®šè¿”å›çš„ã€‚æ‰€ä»¥å¤§å®¶å¦‚æœè¦ç”¨åˆ°è¿›åº¦ï¼Œé™¤äº†æ•°å€¼100å¯ä»¥ç”¨ç­‰å·æ¥åˆ¤æ–­ï¼Œå…¶å®ƒä¸€å®šè¦ç”¨å¤§äºå·æˆ–å°äºå·ï¼Œå¦‚æœç”¨äº†ç­‰å·ï¼Œå¯èƒ½æ°¸è¿œä¹Ÿä¸ä¼šæ‰§è¡Œåˆ°ã€‚</p>\n</li>\n</ul>\n<h2 id=\"è·å–ç½‘é¡µä¸­çš„åŸºæœ¬ä¿¡æ¯\"><a href=\"#è·å–ç½‘é¡µä¸­çš„åŸºæœ¬ä¿¡æ¯\" class=\"headerlink\" title=\"è·å–ç½‘é¡µä¸­çš„åŸºæœ¬ä¿¡æ¯\"></a>è·å–ç½‘é¡µä¸­çš„åŸºæœ¬ä¿¡æ¯</h2><ul>\n<li><p>void  onReceivedIcon(WebView view, Bitmap icon) </p>\n<p>icon A Bitmap containing the favicon for the current page.ç½‘é¡µä¸­é¦–éƒ¨å›¾æ ‡</p>\n</li>\n<li><p>void  onReceivedTitle(WebView view, String title) </p>\n<p>title: A String containing the new title of the document. ç½‘é¡µä¸­æ ‡é¢˜ä¸­çš„æ›´æ”¹ï¼Œé¦–éƒ¨æ ‡é¢˜</p>\n<p>è·å–æ ‡é¢˜çš„æ—¶é—´ä¸»è¦å–å†³äºç½‘é¡µå‰ç«¯è®¾ç½®æ ‡é¢˜çš„ä½ç½®ï¼ŒJSä¸­çš„å‡½æ•°è®¾ç½®ä¹Ÿåœ¨è¿™é‡Œæ¥æ”¶</p>\n</li>\n<li><p>void  onReceivedTouchIconUrl(WebView view, String url, boolean precomposed)  Notify the host application of the url for an apple-touch-icon(è‹¹æœå›¾æ ‡). </p>\n</li>\n<li><p>è‹¹æœä¸ºiOSè®¾å¤‡é…å¤‡äº†apple-touch-iconç§æœ‰å±æ€§ï¼Œæ·»åŠ è¯¥å±æ€§ï¼Œåœ¨iPhone,iPad,iTouchçš„safariæµè§ˆå™¨ä¸Šå¯ä»¥ä½¿ç”¨æ·»åŠ åˆ°ä¸»å±æŒ‰é’®å°†ç½‘ç«™æ·»åŠ åˆ°ä¸»å±å¹•ä¸Šï¼Œæ–¹ä¾¿ç”¨æˆ·ä»¥åè®¿é—®ã€‚apple-touch-icon æ ‡ç­¾æ”¯æŒsizeså±æ€§ï¼Œå¯ä»¥ç”¨æ¥æ”¾ç½®å¯¹åº”ä¸åŒçš„è®¾å¤‡ã€‚</p>\n<p>url: The icon url.å›¾ç‰‡åœ°å€</p>\n<p>precomposed: True if the url is for a precomposed touch icon. æ ‡è®°ä¸ºTrueçš„è¯ä½¿ç”¨åŸå›¾</p>\n</li>\n</ul>\n<h2 id=\"æ‹¦æˆªç½‘é¡µä¸­JSæ§åˆ¶å°æ¶ˆæ¯\"><a href=\"#æ‹¦æˆªç½‘é¡µä¸­JSæ§åˆ¶å°æ¶ˆæ¯\" class=\"headerlink\" title=\"æ‹¦æˆªç½‘é¡µä¸­JSæ§åˆ¶å°æ¶ˆæ¯\"></a>æ‹¦æˆªç½‘é¡µä¸­JSæ§åˆ¶å°æ¶ˆæ¯</h2><p>å½“htmlä¸­è°ƒç”¨consoleç›¸å…³è¾“å‡ºçš„æ—¶å€™ï¼Œå°±ä¼šé€šè¿‡onConsoleMessageè¿›è¡Œé€šçŸ¥</p>\n<p>å’Œalert,prompt,confirmä¸åŒï¼Œæˆ‘ä»¬ä¸éœ€è¦å¼ºåˆ¶è®¾ç½®WebChromeClientï¼ˆä½†æ˜¯ä»éœ€è¦setJavaScriptEnabledä¸ºtrueï¼‰ï¼Œå½“ç‚¹å‡»logæŒ‰é’®æ—¶ï¼Œä¹Ÿä¼šè°ƒç”¨consoleç›¸åº”çš„å‡½æ•°æŠŠæ—¥å¿—æ‰“å°å‡ºæ¥ã€‚</p>\n<p>å¯ä»¥è·å–åˆ°çš„ä¿¡æ¯æœ‰ï¼š</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"meta\">@Override</span></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">boolean</span> <span class=\"title\">onConsoleMessage</span><span class=\"params\">(ConsoleMessage consoleMessage)</span> </span>&#123;</div><div class=\"line\">\tLog.e(<span class=\"string\">\"ncmon\"</span>, <span class=\"string\">\"onConsoleMessage : \"</span></div><div class=\"line\">          + <span class=\"string\">\"\\nmessage=\"</span> + consoleMessage.message()</div><div class=\"line\">          + <span class=\"string\">\"\\nlineNumber=\"</span> + consoleMessage.lineNumber()</div><div class=\"line\">          + <span class=\"string\">\"\\nmessageLevel=\"</span> + consoleMessage.messageLevel()</div><div class=\"line\">          + <span class=\"string\">\"\\nsourceId=\"</span> + consoleMessage.sourceId());</div><div class=\"line\">    <span class=\"keyword\">return</span> <span class=\"keyword\">super</span>.onConsoleMessage(consoleMessage);</div><div class=\"line\">&#125;</div><div class=\"line\">ncmon : onConsoleMessage : </div><div class=\"line\">    message=Uncaught TypeError: Cannot read property <span class=\"string\">'getItem'</span> of <span class=\"keyword\">null</span></div><div class=\"line\">    lineNumber=<span class=\"number\">2</span></div><div class=\"line\">    messageLevel=ERROR</div><div class=\"line\">    sourceId=https:<span class=\"comment\">//m.baidu.com/?from=844b&amp;vit=fps</span></div><div class=\"line\">chromium: [INFO:CONSOLE(<span class=\"number\">2</span>)] <span class=\"string\">\"Uncaught TypeError: Cannot read property 'getItem' of null\"</span>, source: https:<span class=\"comment\">//m.baidu.com/?from=844b&amp;vit=fps (2)</span></div></pre></td></tr></table></figure>\n<p>å¯ä»¥çœ‹åˆ°é™¤äº†æ¥¼ä¸»è¾“å‡ºçš„æ—¥å¿—å¤–ï¼Œè¿˜æœ‰chromiumçš„æ—¥å¿—ï¼Œè¿™é‡Œä¹Ÿå°±è¦ä½“ç°è¿”å›å€¼çš„ä½œç”¨ï¼Œå¦‚æœè¿”å›trueæ—¶ï¼Œå°±è¡¨ç¤ºæ‹¦æˆªäº†consoleè¾“å‡ºï¼Œç³»ç»Ÿå°±ä¸å†é€šè¿‡consoleè¾“å‡ºå‡ºæ¥äº†ï¼›å¦‚æœè¿”å›false(é»˜è®¤å€¼)ï¼Œåˆ™è¡¨ç¤ºæ²¡æœ‰æ‹¦æˆªconsoleè¾“å‡ºï¼Œè°ƒç”¨ç³»ç»Ÿé»˜è®¤å¤„ç†</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">ConsoleMessage</span> </span>&#123;</div><div class=\"line\">    <span class=\"keyword\">private</span> MessageLevel mLevel;</div><div class=\"line\">    <span class=\"keyword\">private</span> String mMessage;</div><div class=\"line\">    <span class=\"keyword\">private</span> String mSourceId;</div><div class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">int</span> mLineNumber;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<h2 id=\"æ‹¦æˆªç½‘é¡µä¸­JSå¼¹æ¡†\"><a href=\"#æ‹¦æˆªç½‘é¡µä¸­JSå¼¹æ¡†\" class=\"headerlink\" title=\"æ‹¦æˆªç½‘é¡µä¸­JSå¼¹æ¡†\"></a>æ‹¦æˆªç½‘é¡µä¸­JSå¼¹æ¡†</h2><p>ä¸‰ç§ç±»å‹çš„å¼¹æ¡†</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">boolean</span> <span class=\"title\">onJsAlert</span><span class=\"params\">(WebView view, String url, String message,</span></span></div><div class=\"line\">        JsResult result) &#123;</div><div class=\"line\">    <span class=\"keyword\">return</span> <span class=\"keyword\">false</span>;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<p>å½“ç½‘é¡µè°ƒç”¨alert()æ¥å¼¹å‡ºalertå¼¹å‡ºæ¡†å‰å›è°ƒï¼Œç”¨ä»¥æ‹¦æˆªalert()å‡½æ•°</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">boolean</span> <span class=\"title\">onJsConfirm</span><span class=\"params\">(WebView view, String url, String message,</span></span></div><div class=\"line\">        JsResult result) &#123;</div><div class=\"line\">    <span class=\"keyword\">return</span> <span class=\"keyword\">false</span>;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<p>å¸¦æœ‰ç¡®å®šå–æ¶ˆæç¤ºï¼Œå½“ç½‘é¡µè°ƒç”¨confirm()æ¥å¼¹å‡ºconfirmå¼¹å‡ºæ¡†å‰å›è°ƒï¼Œç”¨ä»¥æ‹¦æˆªconfirm()å‡½æ•°</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">boolean</span> <span class=\"title\">onJsPrompt</span><span class=\"params\">(WebView view, String url, String message,</span></span></div><div class=\"line\">        String defaultValue, JsPromptResult result) &#123;</div><div class=\"line\">    <span class=\"keyword\">return</span> <span class=\"keyword\">false</span>;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<p>å¸¦æœ‰è¾“å…¥æ¡†çš„å¼¹çª—ï¼Œå½“ç½‘é¡µè°ƒç”¨prompt()æ¥å¼¹å‡ºpromptå¼¹å‡ºæ¡†å‰å›è°ƒï¼Œç”¨ä»¥æ‹¦æˆªprompt()å‡½æ•°</p>\n<ul>\n<li><p>å¤„ç†JSå¼¹æ¡†é¦–å…ˆéœ€è¦è®¾ç½®JavaScriptæ”¯æŒï¼Œä¹Ÿå¿…é¡»è®¾ç½®WebChromeClient.</p>\n</li>\n<li><p>å‚æ•°</p>\n<p>url:page_with_curl:ï¼šå¼¹å‡ºå¯¹è¯æ¡†çš„ç½‘é¡µç½‘å€</p>\n<p>message:speech_balloon::å¯¹è¯æ¡†çš„å†…å®¹</p>\n<p>result:closed_umbrella:: è¿”å›ç»™JavaScriptçš„å“åº”ï¼ŒJsResult.confirm()è¡¨ç¤ºç‚¹å‡»äº†å¼¹å‡ºæ¡†çš„ç¡®å®šæŒ‰é’®ï¼ŒJsResult.cancel()åˆ™è¡¨ç¤ºç‚¹å‡»äº†å¼¹å‡ºæ¡†çš„å–æ¶ˆæŒ‰é’®ã€‚<font color=\"red\">å…¶ä¸­JsPromptResultä¹Ÿæ˜¯ç»§æ‰¿JsResultçš„ï¼Œåªæ˜¯å¤šäº†è¾“å…¥çš„å†…å®¹å˜é‡ (String mStringResult)</font></p>\n</li>\n<li><p>è¿”å›å€¼ </p>\n<p>true Native è‡ªè¡Œå¤„ç†å¼¹çª—é€»è¾‘ï¼Œä¸å¼¹å‡ºalertå¼¹çª—äº†</p>\n<p>false WebView è‡ªè¡Œå¼¹å‡ºalertå¯¹è¯æ¡†å¤„ç†</p>\n<p>å¦‚æœæ˜¯return trueï¼Œæ­¤æ—¶æˆ‘ä»¬å¿…é¡»æ‰‹åŠ¨è°ƒç”¨JsResultçš„.confirm()æˆ–.cancel()æ–¹æ³•ï¼Œå› ä¸ºå¦‚æœæ²¡æœ‰è°ƒç”¨JsResultçš„confirm()æˆ–cancel()æ¥å‘Šè¯‰WebViewä½ çš„å¤„ç†ç»“æœï¼Œåˆ™WebViewå°±ä¼šè®¤ä¸ºè¿™ä¸ªå¼¹å‡ºæ¡†è¿˜ä¸€ç›´å¼¹åœ¨é‚£é‡Œï¼ˆè™½ç„¶æ­¤æ—¶æ ¹æœ¬æ²¡æœ‰å¼¹æ¡†å¼¹å‡ºï¼‰ï¼Œæ‰€ä»¥ä¹‹åä½ å†ç‚¹å‡»alertæŒ‰é’®æ—¶ï¼Œå°†ä¼šæ— æ•ˆã€‚è¿™ä¸€ç‚¹ä¸€å®šè¦æ³¨æ„ã€‚</p>\n</li>\n</ul>\n<h2 id=\"æ‰“å¼€å’Œå…³é—­Window\"><a href=\"#æ‰“å¼€å’Œå…³é—­Window\" class=\"headerlink\" title=\"æ‰“å¼€å’Œå…³é—­Window\"></a>æ‰“å¼€å’Œå…³é—­Window</h2><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">boolean</span> <span class=\"title\">onCreateWindow</span><span class=\"params\">(WebView view, <span class=\"keyword\">boolean</span> isDialog,</span></span></div><div class=\"line\">        <span class=\"keyword\">boolean</span> isUserGesture, Message resultMsg) &#123;</div><div class=\"line\">    <span class=\"keyword\">return</span> <span class=\"keyword\">false</span>;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<p>è¿™ä¸ªæ–¹æ³•å›è°ƒçš„å‰æéœ€è¦è®¾ç½®WebViewå¤šçª—å£æ”¯æŒï¼Œå°±æ˜¯æµè§ˆå™¨çš„å¤šä¸ªtab</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">webSettings.setSupportMultipleWindows(<span class=\"keyword\">true</span>);<span class=\"comment\">//æ”¯æŒå¤šçª—å£ã€‚å¦‚æœè®¾ç½®ä¸ºtrue</span></div></pre></td></tr></table></figure>\n<p>åœ¨Htmlä¸­ï¼Œè¶…çº§é“¾æ¥æ ‡ç­¾aé‡Œæœ‰ä¸€ä¸ªtargetå±æ€§ï¼Œå…¶æ„ä¹‰æ˜¯å†³å®šâ€æ˜¯å¦åœ¨æ–°çª—å£/æ ‡ç­¾é¡µä¸­æ‰“å¼€é“¾æ¥â€ï¼Œå¦‚æœä¸å†™target=â€_blankâ€é‚£ä¹ˆå°±æ˜¯åœ¨ç›¸åŒçš„æ ‡ç­¾é¡µæ‰“å¼€ï¼Œå¦‚æœå†™äº†ï¼Œå°±æ˜¯åœ¨æ–°çš„ç©ºç™½æ ‡ç­¾é¡µä¸­æ‰“å¼€ã€‚æ¯”å¦‚ï¼š</p>\n<figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">a</span> <span class=\"attr\">href</span>=<span class=\"string\">\"https://www.taobao.com/\"</span> <span class=\"attr\">title</span>=<span class=\"string\">\"æ·˜å®\"</span> <span class=\"attr\">target</span>=<span class=\"string\">\"_blank\"</span>&gt;</span>æ–°çª—å£æ‰“å¼€é“¾æ¥<span class=\"tag\">&lt;/<span class=\"name\">a</span>&gt;</span></div></pre></td></tr></table></figure>\n<p>WebViewé»˜è®¤æ˜¯ä¸æ”¯æŒtargetï¼Œç‚¹å‡»ä¸Šé¢çš„é“¾æ¥ä¼šåœ¨å½“å‰WebViewä¸­æ‰“å¼€æ­¤é“¾æ¥ã€‚</p>\n<p>å®Œæ•´é€»è¾‘å¦‚ä¸‹</p>\n<ul>\n<li><p>æ²¡æœ‰è®¾ç½®setSupportMultipleWindowså±æ€§ä¸ºtrue</p>\n<ul>\n<li>æ²¡æœ‰setWebChromeClientï¼šç‚¹å‡»æ­¤é“¾æ¥ä¼šåœ¨å½“å‰WebViewä¸­æ‰“å¼€æ­¤é“¾æ¥</li>\n<li>æœ‰setWebChromeClientï¼šç‚¹å‡»æ­¤é“¾æ¥ä¼šåœ¨å½“å‰WebViewä¸­æ‰“å¼€æ­¤é“¾æ¥ï¼Œä¸ä¼šå›è°ƒonCreateWindowæ–¹æ³•</li>\n</ul>\n</li>\n<li><p>æœ‰è®¾ç½®setSupportMultipleWindowså±æ€§ä¸ºtrue</p>\n<ul>\n<li><p>æ²¡æœ‰setWebChromeClientï¼šç‚¹å‡»æ­¤é“¾æ¥ä¸ä¼šåœ¨å½“å‰WebViewä¸­æ‰“å¼€æ­¤é“¾æ¥</p>\n</li>\n<li><p>æœ‰setWebChromeClient</p>\n<ul>\n<li>æ²¡æœ‰é‡å†™onCreateWindowæ–¹æ³•ï¼šç‚¹å‡»æ­¤é“¾æ¥ä¸ä¼šåœ¨å½“å‰WebViewä¸­æ‰“å¼€æ­¤é“¾æ¥ï¼Œä¼šå›è°ƒonCreateWindowæ–¹æ³•</li>\n<li>æœ‰é‡å†™onCreateWindowæ–¹æ³•ï¼šç‚¹å‡»æ­¤é“¾æ¥ä¸ä¼šåœ¨å½“å‰WebViewä¸­æ‰“å¼€æ­¤é“¾æ¥ï¼Œä¼šå›è°ƒonCreateWindowæ–¹æ³•ï¼Œä¼šåœ¨ä½ æ–°åˆ›å»ºçš„WebViewä¸­æ‰“å¼€æ­¤é“¾æ¥</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"meta\">@Override</span></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">boolean</span> <span class=\"title\">onCreateWindow</span><span class=\"params\">(WebView webView, <span class=\"keyword\">boolean</span> isDialog, <span class=\"keyword\">boolean</span> isUserGesture, Message resultMsg)</span> </span>&#123;</div><div class=\"line\">    Log.i(<span class=\"string\">\"bqt\"</span>, <span class=\"string\">\"ã€onCreateWindowã€‘ \"</span> + isDialog + <span class=\"string\">\"  \"</span> + isUserGesture + <span class=\"string\">\"\\nè¯¦ç»†ä¿¡æ¯\"</span> + resultMsg.toString());</div><div class=\"line\">    <span class=\"keyword\">if</span> (activity != <span class=\"keyword\">null</span>) &#123;</div><div class=\"line\">        WebView childView = <span class=\"keyword\">new</span> WebView(activity);<span class=\"comment\">//Parent WebView cannot host it's own popup window.</span></div><div class=\"line\">        childView.setBackgroundColor(Color.GREEN);</div><div class=\"line\">        childView.setWebViewClient(<span class=\"keyword\">new</span> WebViewClient() &#123;</div><div class=\"line\">            <span class=\"meta\">@Override</span></div><div class=\"line\">            <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">boolean</span> <span class=\"title\">shouldOverrideUrlLoading</span><span class=\"params\">(WebView view, String url)</span> </span>&#123;</div><div class=\"line\">                Log.i(<span class=\"string\">\"bqt\"</span>, <span class=\"string\">\"ã€shouldOverrideUrlLoading-å­ã€‘\"</span>);</div><div class=\"line\">                activity.startActivity(<span class=\"keyword\">new</span> Intent(Intent.ACTION_VIEW, Uri.parse(url)));</div><div class=\"line\">                <span class=\"keyword\">return</span> <span class=\"keyword\">true</span>;</div><div class=\"line\">            &#125;</div><div class=\"line\">        &#125;);</div><div class=\"line\">        WebView.WebViewTransport transport = (WebView.WebViewTransport) resultMsg.obj;</div><div class=\"line\">        transport.setWebView(childView);<span class=\"comment\">//setWebViewå’ŒgetWebViewä¸¤ä¸ªæ–¹æ³•</span></div><div class=\"line\">        resultMsg.sendToTarget();</div><div class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">true</span>;</div><div class=\"line\">    &#125; <span class=\"keyword\">else</span> <span class=\"keyword\">return</span> <span class=\"keyword\">super</span>.onCreateWindow(webView, isDialog, isUserGesture, resultMsg);<span class=\"comment\">//é»˜è®¤æ˜¯returns false</span></div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<p>æ„Ÿè§‰æµè§ˆå™¨æ‰ä¼šç”¨åˆ°è¿™ä¸ªAPI,å¸¸è§„åº”ç”¨åŸºæœ¬éƒ½æ˜¯æ‰“å¼€è‡ªå·±å®šåˆ¶çš„Htmlé¡µé¢</p>\n<p>å¯¹åº”çš„è¿˜æœ‰ä¸€ä¸ªå…³é—­Windowçš„APIï¼Œåœ¨JSè°ƒç”¨window.close()æ–¹æ³•æ—¶ä¼šå›è°ƒæ­¤æ–¹æ³•ã€<button onclick=\"window.close()\">å…³é—­çª—å£</button>ã€‘</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">onCloseWindow</span><span class=\"params\">(WebView window)</span> </span>&#123;&#125;</div></pre></td></tr></table></figure>\n<h2 id=\"æ–‡ä»¶é€‰æ‹©å™¨\"><a href=\"#æ–‡ä»¶é€‰æ‹©å™¨\" class=\"headerlink\" title=\"æ–‡ä»¶é€‰æ‹©å™¨\"></a>æ–‡ä»¶é€‰æ‹©å™¨</h2><p>è¿™ä¸ªæ–¹æ³•åœ¨é¡¹ç›®ä¸­å¾ˆå¸¸ç”¨ï¼ŒHtmlä¸­å¦‚æœéœ€è¦é€‰æ‹©æœ¬æœºæ–‡ä»¶å°±éœ€è¦æŠŠæ–‡ä»¶ä¼ è¿‡å»ã€‚åŸºæœ¬æ“ä½œä¸ºæ‰“å¼€æ–‡ä»¶ç®¡ç†å™¨å†æŠŠé€‰æ‹©çš„æ–‡ä»¶ä¼ åˆ°ç½‘é¡µä¸­ã€‚æˆ‘ä¹Ÿæœ‰ç”¨åˆ°ï¼Œå°±è´´ä¸€ä¸‹å®Œæ•´çš„ä»£ç ç‰‡æ®µã€‚</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div><div class=\"line\">40</div><div class=\"line\">41</div><div class=\"line\">42</div><div class=\"line\">43</div><div class=\"line\">44</div><div class=\"line\">45</div><div class=\"line\">46</div><div class=\"line\">47</div><div class=\"line\">48</div><div class=\"line\">49</div><div class=\"line\">50</div><div class=\"line\">51</div><div class=\"line\">52</div><div class=\"line\">53</div><div class=\"line\">54</div><div class=\"line\">55</div><div class=\"line\">56</div><div class=\"line\">57</div><div class=\"line\">58</div><div class=\"line\">59</div><div class=\"line\">60</div><div class=\"line\">61</div><div class=\"line\">62</div><div class=\"line\">63</div><div class=\"line\">64</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">//For Android  &gt;= 4.1</span></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">openFileChooser</span><span class=\"params\">(ValueCallback&lt;Uri&gt; valueCallback, String acceptType, String capture)</span> </span>&#123;</div><div class=\"line\">    uploadMessage = valueCallback;</div><div class=\"line\">    openImageChooserActivity();</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">// For Android &gt;= 5.0</span></div><div class=\"line\"><span class=\"meta\">@Override</span></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">boolean</span> <span class=\"title\">onShowFileChooser</span><span class=\"params\">(WebView webView, ValueCallback&lt;Uri[]&gt; filePathCallback, WebChromeClient.FileChooserParams fileChooserParams)</span> </span>&#123;</div><div class=\"line\">    uploadMessageAboveL = filePathCallback;</div><div class=\"line\">    Intent i = <span class=\"keyword\">new</span> Intent(Intent.ACTION_GET_CONTENT);</div><div class=\"line\">    i.addCategory(Intent.CATEGORY_OPENABLE);</div><div class=\"line\">    <span class=\"keyword\">if</span> (fileChooserParams != <span class=\"keyword\">null</span> &amp;&amp; fileChooserParams.getAcceptTypes() != <span class=\"keyword\">null</span></div><div class=\"line\">                &amp;&amp; fileChooserParams.getAcceptTypes().length &gt; <span class=\"number\">0</span>) &#123;</div><div class=\"line\">\t\ti.setType(fileChooserParams.getAcceptTypes()[<span class=\"number\">0</span>]);</div><div class=\"line\">    &#125; <span class=\"keyword\">else</span> &#123;</div><div class=\"line\">\t\ti.setType(<span class=\"string\">\"*/*\"</span>);</div><div class=\"line\">    &#125;</div><div class=\"line\">    startActivityForResult(Intent.createChooser(i, <span class=\"string\">\"File Chooser\"</span>), FILECHOOSER_RESULTCODE);</div><div class=\"line\">    <span class=\"keyword\">return</span> <span class=\"keyword\">true</span>;</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\"> <span class=\"meta\">@Override</span></div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">protected</span> <span class=\"keyword\">void</span> <span class=\"title\">onActivityResult</span><span class=\"params\">(<span class=\"keyword\">int</span> requestCode, <span class=\"keyword\">int</span> resultCode, Intent data)</span> </span>&#123;</div><div class=\"line\">        <span class=\"keyword\">super</span>.onActivityResult(requestCode, resultCode, data);</div><div class=\"line\">        <span class=\"keyword\">if</span> (requestCode == FILE_CHOOSER_RESULT_CODE) &#123;</div><div class=\"line\">            <span class=\"keyword\">if</span> (<span class=\"keyword\">null</span> == uploadMessage &amp;&amp; <span class=\"keyword\">null</span> == uploadMessageAboveL) &#123;</div><div class=\"line\">                <span class=\"keyword\">return</span>;</div><div class=\"line\">            &#125;</div><div class=\"line\">            Uri result = data == <span class=\"keyword\">null</span> || resultCode != RESULT_OK ? <span class=\"keyword\">null</span> : data.getData();</div><div class=\"line\">            <span class=\"keyword\">if</span> (uploadMessageAboveL != <span class=\"keyword\">null</span>) &#123;</div><div class=\"line\">                onActivityResultAboveL(requestCode, resultCode, data);</div><div class=\"line\">            &#125; <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (uploadMessage != <span class=\"keyword\">null</span>) &#123;</div><div class=\"line\">                uploadMessage.onReceiveValue(result);</div><div class=\"line\">                uploadMessage = <span class=\"keyword\">null</span>;</div><div class=\"line\">            &#125;</div><div class=\"line\">        &#125;</div><div class=\"line\">    &#125;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"meta\">@TargetApi</span>(Build.VERSION_CODES.LOLLIPOP)</div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">void</span> <span class=\"title\">onActivityResultAboveL</span><span class=\"params\">(<span class=\"keyword\">int</span> requestCode, <span class=\"keyword\">int</span> resultCode, Intent intent)</span> </span>&#123;</div><div class=\"line\">        <span class=\"keyword\">if</span> (requestCode != FILE_CHOOSER_RESULT_CODE || uploadMessageAboveL == <span class=\"keyword\">null</span>) &#123;</div><div class=\"line\">            <span class=\"keyword\">return</span>;</div><div class=\"line\">        &#125;</div><div class=\"line\">        Uri[] results = <span class=\"keyword\">null</span>;</div><div class=\"line\">        <span class=\"keyword\">if</span> (resultCode == Activity.RESULT_OK) &#123;</div><div class=\"line\">            <span class=\"keyword\">if</span> (intent != <span class=\"keyword\">null</span>) &#123;</div><div class=\"line\">                String dataString = intent.getDataString();</div><div class=\"line\">                ClipData clipData = intent.getClipData();</div><div class=\"line\">                <span class=\"keyword\">if</span> (clipData != <span class=\"keyword\">null</span>) &#123;</div><div class=\"line\">                    results = <span class=\"keyword\">new</span> Uri[clipData.getItemCount()];</div><div class=\"line\">                    <span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> i = <span class=\"number\">0</span>; i &lt; clipData.getItemCount(); i++) &#123;</div><div class=\"line\">                        ClipData.Item item = clipData.getItemAt(i);</div><div class=\"line\">                        results[i] = item.getUri();</div><div class=\"line\">                    &#125;</div><div class=\"line\">                &#125;</div><div class=\"line\">                <span class=\"keyword\">if</span> (dataString != <span class=\"keyword\">null</span>) &#123;</div><div class=\"line\">                    results = <span class=\"keyword\">new</span> Uri[]&#123;Uri.parse(dataString)&#125;;</div><div class=\"line\">                &#125;</div><div class=\"line\">            &#125;</div><div class=\"line\">        &#125;</div><div class=\"line\">        uploadMessageAboveL.onReceiveValue(results);</div><div class=\"line\">        uploadMessageAboveL = <span class=\"keyword\">null</span>;</div><div class=\"line\">    &#125;</div></pre></td></tr></table></figure>\n<p>@params filePathCallback:  æä¾›è¦ä¸Šä¼ çš„æ–‡ä»¶çš„è·¯å¾„åˆ—è¡¨, or NULL to cancel. Must only be called if the showFileChooser implementations returns true.</p>\n<p>@params fileChooserParams:  æè¿°è¦æ‰“å¼€çš„æ–‡ä»¶é€‰æ‹©å™¨çš„æ¨¡å¼ï¼Œä»¥åŠä¸ä¹‹ä¸€èµ·ä½¿ç”¨çš„é€‰é¡¹ã€‚</p>\n<h2 id=\"è§†é¢‘-å…¨å±-æ’­æ”¾\"><a href=\"#è§†é¢‘-å…¨å±-æ’­æ”¾\" class=\"headerlink\" title=\"è§†é¢‘(å…¨å±)æ’­æ”¾\"></a>è§†é¢‘(å…¨å±)æ’­æ”¾</h2><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> Bitmap <span class=\"title\">getDefaultVideoPoster</span><span class=\"params\">()</span> </span>&#123;</div><div class=\"line\">    <span class=\"keyword\">return</span> <span class=\"keyword\">null</span>;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<p>Htmlä¸­ï¼Œè§†é¢‘ï¼ˆvideoï¼‰æ§ä»¶åœ¨æ²¡æœ‰æ’­æ”¾çš„æ—¶å€™å°†ç»™ç”¨æˆ·å±•ç¤ºä¸€å¼ â€œæµ·æŠ¥â€å›¾ç‰‡ï¼ˆé¢„è§ˆå›¾ï¼‰ã€‚å…¶é¢„è§ˆå›¾æ˜¯ç”±Htmlä¸­videoæ ‡ç­¾çš„<a href=\"http://www.w3school.com.cn/tags/att_video_poster.asp\" target=\"_blank\" rel=\"external\">poster</a>å±æ€§æ¥æŒ‡å®šçš„ã€‚å¦‚æœå¼€å‘è€…æ²¡æœ‰è®¾ç½®posterå±æ€§, åˆ™å¯ä»¥é€šè¿‡è¿™ä¸ªæ–¹æ³•æ¥è®¾ç½®é»˜è®¤çš„é¢„è§ˆå›¾ã€‚</p>\n<figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">video</span> <span class=\"attr\">controls</span> <span class=\"attr\">poster</span>=<span class=\"string\">\"/images/w3school.gif\"</span>&gt;</span></div><div class=\"line\">   <span class=\"tag\">&lt;<span class=\"name\">source</span> <span class=\"attr\">src</span>=<span class=\"string\">\"movie.mp4\"</span> <span class=\"attr\">type</span>=<span class=\"string\">\"video/mp4\"</span>&gt;</span></div><div class=\"line\">   <span class=\"tag\">&lt;<span class=\"name\">source</span> <span class=\"attr\">src</span>=<span class=\"string\">\"movie.ogg\"</span> <span class=\"attr\">type</span>=<span class=\"string\">\"video/ogg\"</span>&gt;</span></div><div class=\"line\">   Your browser does not support the video tag.</div><div class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">video</span>&gt;</span></div></pre></td></tr></table></figure>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> View <span class=\"title\">getVideoLoadingProgressView</span><span class=\"params\">()</span> </span>&#123;</div><div class=\"line\">    <span class=\"keyword\">return</span> <span class=\"keyword\">null</span>;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<p>æ’­æ”¾è§†é¢‘æ—¶ï¼Œåœ¨ç¬¬ä¸€å¸§å‘ˆç°ä¹‹å‰ï¼Œéœ€è¦èŠ±ä¸€å®šçš„æ—¶é—´æ¥è¿›è¡Œæ•°æ®ç¼“å†²ã€‚ChromeClientå¯ä»¥ä½¿ç”¨è¿™ä¸ªå‡½æ•°æ¥æä¾›ä¸€ä¸ªåœ¨æ•°æ®ç¼“å†²æ—¶æ˜¾ç¤ºçš„è§†å›¾ã€‚ ä¾‹å¦‚,ChromeClientå¯ä»¥åœ¨ç¼“å†²æ—¶æ˜¾ç¤ºä¸€ä¸ªè½¬è½®åŠ¨ç”»ã€‚</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">onShowCustomView</span><span class=\"params\">(View view, CustomViewCallback callback)</span> </span>&#123;&#125;;</div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">onHideCustomView</span><span class=\"params\">()</span> </span>&#123;&#125;</div></pre></td></tr></table></figure>\n<p>é€šçŸ¥ä¸»æœºåº”ç”¨webviewéœ€è¦æ˜¾ç¤ºä¸€ä¸ªcustom viewï¼Œä¸»è¦æ˜¯ç”¨åœ¨è§†é¢‘å…¨å± HTML5 Video supportã€‚</p>\n<p>ç½‘é¡µä¸­æœ‰H5æ’­æ”¾flash videoçš„æ—¶å€™æŒ‰ä¸‹å…¨å±æŒ‰é’®å°†ä¼šè°ƒç”¨åˆ°è¿™ä¸ªæ–¹æ³•ï¼Œä¸€èˆ¬ç”¨ä½œè®¾ç½®ç½‘é¡µæ’­æ”¾å…¨å±æ“ä½œã€‚</p>\n<h2 id=\"è·å–åœ°ç†ä½ç½®\"><a href=\"#è·å–åœ°ç†ä½ç½®\" class=\"headerlink\" title=\"è·å–åœ°ç†ä½ç½®\"></a>è·å–åœ°ç†ä½ç½®</h2><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">onGeolocationPermissionsShowPrompt</span><span class=\"params\">(String origin, GeolocationPermissions.Callback callback)</span> </span>&#123;&#125;</div><div class=\"line\"></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">onGeolocationPermissionsHidePrompt</span><span class=\"params\">()</span> </span>&#123;&#125;</div></pre></td></tr></table></figure>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">GeolocationPermissions</span> </span>&#123;</div><div class=\"line\">    <span class=\"comment\">/**</span></div><div class=\"line\">     * A callback interface used by the host application to set the Geolocation</div><div class=\"line\">     * permission state for an origin.</div><div class=\"line\">     */</div><div class=\"line\">    <span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">interface</span> <span class=\"title\">Callback</span> </span>&#123;</div><div class=\"line\">        <span class=\"comment\">/**</span></div><div class=\"line\">         * Sets the Geolocation permission state for the supplied origin.</div><div class=\"line\">         *</div><div class=\"line\">         * <span class=\"doctag\">@param</span> origin the origin for which permissions are set</div><div class=\"line\">         * <span class=\"doctag\">@param</span> allow whether or not the origin should be allowed to use the</div><div class=\"line\">         *              Geolocation API</div><div class=\"line\">         * <span class=\"doctag\">@param</span> retain whether the permission should be retained beyond the</div><div class=\"line\">         *               lifetime of a page currently being displayed by a</div><div class=\"line\">         *               WebView</div><div class=\"line\">         */</div><div class=\"line\">        <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">invoke</span><span class=\"params\">(String origin, <span class=\"keyword\">boolean</span> allow, <span class=\"keyword\">boolean</span> retain)</span></span>;</div><div class=\"line\">    &#125;;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<p>JavaScriptä¸­æœ‰è°ƒç”¨å®šä½çš„APIæ—¶ä¼šè°ƒç”¨æœ¬æ–¹æ³•</p>\n<p>@param origin æ¥æºï¼Œè°è°ƒç”¨çš„ï¼Œä¼ å›ç»™è°</p>\n<p>@param allow æ˜¯å¦å…è®¸æœ¬æ¬¡å®šä½</p>\n<p>@param retain æ˜¯å¦ä¿æŒå…è®¸å®šä½çŠ¶æ€ï¼Œä¼ é€’äº†trueåï¼Œæœ¬WebViewä¹‹åéƒ½å¯ä»¥è·å¾—å½“å‰ä½ç½®ä¿¡æ¯ã€‚</p>\n<p>å¯¹åº”çš„onGeolocationPermissionsHidePromptï¼ˆï¼‰å°±æ˜¯é€šçŸ¥åº”ç”¨ç¨‹åºï¼Œåœ°ç†ä½ç½®æƒé™è¯·æ±‚å·²è¢«å–æ¶ˆ</p>\n<h2 id=\"è¯·æ±‚æƒé™\"><a href=\"#è¯·æ±‚æƒé™\" class=\"headerlink\" title=\"è¯·æ±‚æƒé™\"></a>è¯·æ±‚æƒé™</h2><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div></pre></td><td class=\"code\"><pre><div class=\"line\">    <span class=\"comment\">/**</span></div><div class=\"line\">     * Notify the host application that web content is requesting permission to</div><div class=\"line\">     * access the specified resources and the permission currently isn't granted</div><div class=\"line\">     * or denied. The host application must invoke &#123;<span class=\"doctag\">@link</span> PermissionRequest#grant(String[])&#125;</div><div class=\"line\">     * or &#123;<span class=\"doctag\">@link</span> PermissionRequest#deny()&#125;.</div><div class=\"line\">     *</div><div class=\"line\">     * If this method isn't overridden, the permission is denied.</div><div class=\"line\">     *</div><div class=\"line\">     * <span class=\"doctag\">@param</span> request the PermissionRequest from current web content.</div><div class=\"line\">     */</div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">onPermissionRequest</span><span class=\"params\">(PermissionRequest request)</span> </span>&#123;</div><div class=\"line\">    request.deny();</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">/**</span></div><div class=\"line\"> * Notify the host application that the given permission request</div><div class=\"line\"> * has been canceled. Any related UI should therefore be hidden.</div><div class=\"line\"> *</div><div class=\"line\"> * <span class=\"doctag\">@param</span> request the PermissionRequest that needs be canceled.</div><div class=\"line\"> */</div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">onPermissionRequestCanceled</span><span class=\"params\">(PermissionRequest request)</span> </span>&#123;&#125;</div></pre></td></tr></table></figure>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">abstract</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">PermissionRequest</span> </span>&#123;</div><div class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">final</span> <span class=\"keyword\">static</span> String RESOURCE_VIDEO_CAPTURE = <span class=\"string\">\"android.webkit.resource.VIDEO_CAPTURE\"</span>;</div><div class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">final</span> <span class=\"keyword\">static</span> String RESOURCE_AUDIO_CAPTURE = <span class=\"string\">\"android.webkit.resource.AUDIO_CAPTURE\"</span>;</div><div class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">final</span> <span class=\"keyword\">static</span> String RESOURCE_PROTECTED_MEDIA_ID =</div><div class=\"line\">            <span class=\"string\">\"android.webkit.resource.PROTECTED_MEDIA_ID\"</span>;</div><div class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">final</span> <span class=\"keyword\">static</span> String RESOURCE_MIDI_SYSEX = <span class=\"string\">\"android.webkit.resource.MIDI_SYSEX\"</span>;</div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">abstract</span> Uri <span class=\"title\">getOrigin</span><span class=\"params\">()</span></span>;</div><div class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">abstract</span> String[] getResources();</div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">abstract</span> <span class=\"keyword\">void</span> <span class=\"title\">grant</span><span class=\"params\">(String[] resources)</span></span>;</div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">abstract</span> <span class=\"keyword\">void</span> <span class=\"title\">deny</span><span class=\"params\">()</span></span>;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<p>@method getorigin()è·å–æ¥æº</p>\n<p>@method getResources()è·å–è¯·æ±‚çš„æƒé™åˆ—è¡¨</p>\n<p>@method grant ()å…è®¸çš„æƒé™åˆ—è¡¨</p>\n<p>@method deny()æ‹’ç»äº†æƒé™</p>\n<p>éœ€è¦çš„å°±æ˜¯PermissRequestä¸­å®šä¹‰çš„å››ä¸ªå¸¸äº®ä»£è¡¨çš„æƒé™ï¼Œå…³äºæƒé™çš„ä½¿ç”¨æ˜¯å…¶ä»–çŸ¥è¯†ç‚¹ï¼Œå¤§å®¶å¯ä»¥çœ‹çœ‹è¿™ä¸ª<a href=\"https://codeday.me/bug/20181125/420409.html\" target=\"_blank\" rel=\"external\">æ —å­</a>ã€‚</p>\n<h2 id=\"å…¶ä»–æ–¹æ³•\"><a href=\"#å…¶ä»–æ–¹æ³•\" class=\"headerlink\" title=\"å…¶ä»–æ–¹æ³•\"></a>å…¶ä»–æ–¹æ³•</h2><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">/**</span></div><div class=\"line\"> *è·å¾—æ‰€æœ‰è®¿é—®å†å²é¡¹ç›®çš„åˆ—è¡¨ï¼Œç”¨äºé“¾æ¥ç€è‰²ã€‚</div><div class=\"line\"> */</div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">getVisitedHistory</span><span class=\"params\">(ValueCallback&lt;String[]&gt; callback)</span> </span>&#123;</div><div class=\"line\">&#125;</div><div class=\"line\"><span class=\"comment\">/**</span></div><div class=\"line\"> *webviewè¯·æ±‚å¾—åˆ°ç„¦ç‚¹ï¼Œå‘ç”Ÿè¿™ä¸ªä¸»è¦æ˜¯å½“å‰webviewä¸æ˜¯å‰å°çŠ¶æ€ï¼Œæ˜¯åå°webviewã€‚</div><div class=\"line\"> */</div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">onRequestFocus</span><span class=\"params\">(WebView view)</span> </span>&#123;&#125;</div></pre></td></tr></table></figure>","next":{"title":"Android WebViewå¿…çŸ¥å¿…ä¼š(2)-WebSettings","slug":"webview-learning-WebSettings"},"link":"http://ncmon.com/post/webview-learning-WebChromeClient/","toc":[{"title":"ç®€ä»‹","id":"ç®€ä»‹","index":"1"},{"title":"è·å–ç½‘é¡µçš„åŠ è½½è¿›åº¦","id":"è·å–ç½‘é¡µçš„åŠ è½½è¿›åº¦","index":"2"},{"title":"è·å–ç½‘é¡µä¸­çš„åŸºæœ¬ä¿¡æ¯","id":"è·å–ç½‘é¡µä¸­çš„åŸºæœ¬ä¿¡æ¯","index":"3"},{"title":"æ‹¦æˆªç½‘é¡µä¸­JSæ§åˆ¶å°æ¶ˆæ¯","id":"æ‹¦æˆªç½‘é¡µä¸­JSæ§åˆ¶å°æ¶ˆæ¯","index":"4"},{"title":"æ‹¦æˆªç½‘é¡µä¸­JSå¼¹æ¡†","id":"æ‹¦æˆªç½‘é¡µä¸­JSå¼¹æ¡†","index":"5"},{"title":"æ‰“å¼€å’Œå…³é—­Window","id":"æ‰“å¼€å’Œå…³é—­Window","index":"6"},{"title":"æ–‡ä»¶é€‰æ‹©å™¨","id":"æ–‡ä»¶é€‰æ‹©å™¨","index":"7"},{"title":"è§†é¢‘(å…¨å±)æ’­æ”¾","id":"è§†é¢‘-å…¨å±-æ’­æ”¾","index":"8"},{"title":"è·å–åœ°ç†ä½ç½®","id":"è·å–åœ°ç†ä½ç½®","index":"9"},{"title":"è¯·æ±‚æƒé™","id":"è¯·æ±‚æƒé™","index":"10"},{"title":"å…¶ä»–æ–¹æ³•","id":"å…¶ä»–æ–¹æ³•","index":"11"}],"copyright":{"author":"ncmon","link":"<a href=\"http://ncmon.com/post/webview-learning-WebChromeClient/\" title=\"Android WebViewå¿…çŸ¥å¿…ä¼š(3)-WebChromeClient\">http://ncmon.com/post/webview-learning-WebChromeClient/</a>","license":"Attribution-NonCommercial-NoDerivatives 4.0 International (<a href=\"https://creativecommons.org/licenses/by-nc-sa/4.0/\" rel=\"external nofollow noopener\" target=\"_blank\">CC BY-NC-ND 4.0</a>)"},"reward":true}